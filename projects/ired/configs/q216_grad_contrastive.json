{
  "experiment_name": "q216_grad_contrastive",
  "description": "NEW APPROACH: Gradient-contrastive loss. Instead of contrasting energy VALUES (which causes explosion or collapse), contrast DENOISING ERROR. Loss: softplus((MSE_pos.detach() - MSE_neg) / T) where MSE_pos = ||pred_pos - eps||^2, MSE_neg = ||pred_neg - eps||^2. Positive samples should denoise better than negative samples. No energy explosion risk: loss operates entirely in prediction space. Compatible with pred=grad(E)/B_norm architecture.",
  "investigation": "ired-cd",
  "ablation_stage": "gradient_contrastive",
  "mining_strategy": "cd_langevin_replay",
  "rank": 20,
  "ood": false,
  "diffusion_steps": 10,
  "batch_size": 2048,
  "train_steps": 100000,
  "learning_rate": 0.0001,
  "use_scalar_energy": true,
  "use_ired_contrastive_loss": false,
  "use_gradient_contrastive": true,
  "gc_temperature": 1.0,
  "use_langevin": true,
  "mining_opt_steps": 1,
  "mining_noise_scale": 1.5,
  "langevin_sigma_multiplier": 0.05,
  "use_replay_buffer": true,
  "replay_buffer_size": 10000,
  "replay_buffer_buckets": 16,
  "replay_sample_prob": 0.95,
  "use_cd_loss": false,
  "energy_loss_weight": 0.05,
  "energy_reg_weight": 0.0,
  "use_residual_filter": false,
  "use_energy_schedule": false,
  "adam_betas": [0.0, 0.999],
  "output_dir": "results/ds_inverse/q216_grad_contrastive",
  "notes": "Gradient-contrastive: shape gradient FIELD not energy values. Negatives from easy Langevin (noise_scale=1.5, steps=1). Loss pushes pred_neg away from eps at negative locations. MSE_pos detached so denoising objective is not double-counted. SUCCESS criteria: pred_normâ†’19.4 (like q211), val MSE approaches or beats 0.0097. If val MSE > 0.015 at 100k, gradient-contrastive does not improve over baseline. Key diagnostic: GC-DIAG shows mse_gap = mse_neg - mse_pos; should be > 0 and growing."
}
