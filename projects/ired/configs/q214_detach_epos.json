{
  "experiment_name": "q214_detach_epos",
  "description": "FIX: Detach E_pos in contrastive loss so only E_neg receives contrastive gradient. E_pos grows freely from denoising → energies can reach ~400k level → pred_norm → ~19 → denoising works. Root cause of q213 failure: softplus((E_pos-E_neg)/T) gradient pushes E_pos DOWN, fighting denoising which needs large E_pos for large ||dE/dx||. Fix: e_pos_logit = e_pos.detach(), so contrastive only pushes E_neg up.",
  "investigation": "ired-cd",
  "ablation_stage": "detach_epos_contrastive",
  "mining_strategy": "cd_langevin_replay",
  "rank": 20,
  "ood": false,
  "diffusion_steps": 10,
  "batch_size": 2048,
  "train_steps": 100000,
  "learning_rate": 0.0001,
  "use_scalar_energy": true,
  "use_ired_contrastive_loss": true,
  "detach_epos_contrastive": true,
  "contrastive_temperature": 1000.0,
  "use_langevin": true,
  "mining_opt_steps": 1,
  "mining_noise_scale": 0.1,
  "langevin_sigma_multiplier": 0.05,
  "use_replay_buffer": true,
  "replay_buffer_size": 10000,
  "replay_buffer_buckets": 16,
  "replay_sample_prob": 0.95,
  "use_cd_loss": false,
  "energy_loss_weight": 0.05,
  "energy_reg_weight": 0.0,
  "use_residual_filter": false,
  "use_energy_schedule": false,
  "adam_betas": [0.0, 0.999],
  "output_dir": "results/ds_inverse/q214_detach_epos",
  "notes": "Same as q213 but with detach_epos_contrastive=true. Contrastive gradient only flows through E_neg (pushes negatives to higher energy). E_pos is trained only by denoising MSE => can grow freely to ~400k level => pred_norm => ~19.4 => MSE => ~0.0097. Expected: val MSE ~0.009-0.01 if fix works, E_pos >> E_neg (energies grow large), pred_norm ~19."
}
